<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title></title><meta name="description" content="Documentation for "/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title"></a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1></h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#hostbridge-alpha" id="hostbridge-alpha" style="color: inherit; text-decoration: none;">
  <h1>hostbridge (alpha)</h1>
</a>
<p><em>This is currently sponsorware, so it is only available to sponsors or others with explicit access. You may run into toolchain issues working with a private repository, if so please refer to this <a href="https://github.com/tractordev/tractordev.github.io/wiki/Private-Repository">wiki page</a>.</em></p>
<p>Hostbridge is an executable that exposes common APIs for building webview-based desktop applications and integrating with the GUI shell in a way that is platform (Win, Mac, Linux) and language agnostic. This makes it a simple, compact primitive for building your own native cross-platform Electron-style applications, alternative or specialized Electron-style frameworks, or even simple scripts for customizing your desktop experience. </p>
<p>It provides these high-level API modules:</p>
<ul>
<li><strong>window</strong>: create and manage native windows with a native (non-Chromium) webview</li>
<li><strong>menu</strong>: create and manage native menus</li>
<li><strong>app</strong>: manage desktop application properties (lifecycle, default menus, startup mode, icons, etc)</li>
<li><strong>shell</strong>: native desktop shell dialogs, notifications, clipboard, global shortcuts</li>
<li><strong>system</strong>: system resource information (displays, cpu/memory, OS info)</li>
</ul>
<p>Hostbridge runs as a subprocess helper with communication over STDIO using <a href="https://github.com/tractordev/qtalk">qtalk</a>. Running as a subprocess means regardless of language it is always distributed as the same single binary, frees your program from the restrictive and error-prone GUI app threading model, and avoids native extensions/FFI that can complicate the build and install for your program.</p>
<p>Currently there are two languages supported: Go and JavaScript. Adding language support is straightforward and can be done using <a href="">this guide</a>.</p>

<a href="#getting-and-distributing" id="getting-and-distributing" style="color: inherit; text-decoration: none;">
  <h2>Getting and distributing</h2>
</a>
<p>A framework, application, or tool built with hostbridge may choose to embed the hostbridge binary within itself, but soon it will be available to download as a standalone binary for use as a package dependency or to write scripts against directly. For now, you can clone this repo and build the binary with:</p>
<pre><code class="language-bash"><span class="hl-0">make hostbridge</span>
</code></pre>
<p>The dependencies for building are <a href="https://go.dev/">Go</a>, <a href="https://www.rust-lang.org/tools/install">Rust</a> (for the moment), and platform libraries (for example, XCode Developer Tools on Mac).</p>

<a href="#builtin-electron-alternative" id="builtin-electron-alternative" style="color: inherit; text-decoration: none;">
  <h2>Builtin Electron alternative</h2>
</a>
<p>Since hostbridge is just an API for native app functionality, you still need to write and bundle your application. This is why hostbridge can be seen as a runtime primitive for building your own Electron framework. To get started quickly, there is a build subcommand that can take some web assets and produce a single distributable binary. This build command is built-in to the hostbridge binary, but also requires Go installed to run. Perhaps eventually Go can be bundled with it as well.</p>
<p>This framework is very simple, much simpler than Electron. The minimal workflow is:</p>
<ul>
<li>build or install <code>hostbridge</code></li>
<li>make an <code>index.html</code> file </li>
<li>run <code>hostbridge build</code> in that directory</li>
<li>get an executable that contains and runs the page in a native window</li>
</ul>
<p>Any other assets in the directory are bundled and served as well. Any page can include <code>/-/hostbridge.js</code> and then use the <code>$host</code> global to access the hostbridge API to create other windows, etc letting you build an entire native application with HTML and JavaScript, without a drop of NodeJS or NPM modules.</p>
<p>From the <code>demo</code> directory, which includes an example HTML file for this, assuming <code>hostbridge</code> was built in the project root, you can run:</p>
<pre><code class="language-bash"><span class="hl-0">../hostbridge build</span>
</code></pre>
<p>There should now be a <code>demo</code> executable (named after the directory) that starts a native application based on your web assets. The main window can be customized from the HTML by including a meta tag in the <code>index.html</code> like <code>&lt;meta name=&quot;window&quot; content=&quot;center=true,width=800,height=600&quot; /&gt;</code>.</p>
<p>You can even extend the capabilities accessible from <code>$host</code> by including a Go source file in the directory that add methods to an <code>rpc</code> struct type of the <code>main</code> package. Any method on this struct will be callable from JavaScript.</p>
<p>Since this framework and builder is meant as an <em>example</em> and a quick development tool, it doesn&#39;t, for example, create a signed app bundle with manifest, etc. Only an executable, which you can then either manually or using another tool make into an app bundle fit for an App Store. </p>

<a href="#building-your-own-application" id="building-your-own-application" style="color: inherit; text-decoration: none;">
  <h2>Building your own application</h2>
</a>
<p>As long as you have a hostbridge client in your language, you can build a program against the hostbridge API giving you much more control over how you build your application, or whether it&#39;s even a full blown application. It could be a Python script. </p>
<p>The above builder is basically just a wrapper around a pre-made Go program, which conveniently has support to bundle static files into the binary it produces. Rust has this capability built-in as well, but many languages have a tool or mechanism to do something like this.</p>
<p>To see how you can work against the hostbridge API directly, lets recreate a program similar to what the above builder wrote for us. This could be any language, but for convenience, we&#39;ll be using Go.</p>
<pre><code class="language-golang">package main

import (
    &quot;context&quot;
    &quot;embed&quot;
    &quot;log&quot;
    &quot;net/http&quot;
    &quot;strings&quot;

    &quot;tractor.dev/hostbridge/client&quot;
    &quot;tractor.dev/hostbridge/apputil&quot;
)

//go:embed *.html
var assets embed.FS

func main() {
    // this starts the hostbridge subprocess
    // and returns a client for its API
    bridge, err := client.Spawn()
    if err != nil {
        log.Fatal(err)
    }

    bridge.OnEvent = func(event client.Event) {
        // just so we can see what kind of events
        // we get. most are from window interactions
        log.Println(event)

        // if a close is attempted on our main window,
        // we close the client which will end the program
        if event.Type == client.EventClose &amp;&amp; event.WindowID == 1 {
            bridge.Close()
        }
    }

    http.Handle(&quot;/&quot;, http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        // handle requests for the /-/hostbridge.js file and
        // the WebSocket endpoint it connects to, which then
        // proxies to our hostbridge client
        if strings.HasPrefix(r.URL.Path, &quot;/-/&quot;) {
            apputil.BackendServer(bridge, nil).ServeHTTP(w, r)
            return
        }
        // otherwise serve the embedded assets picked up at build time
        http.FileServer(http.FS(assets)).ServeHTTP(w, r)
    }))
    go http.ListenAndServe(&quot;:8888&quot;, nil)

    ctx := context.Background()

    // set up some default window options that can be overwritten by a
    // meta tag with name=&quot;window&quot; in the index.html of our embedded assets
    opts := apputil.OptionsFromHTML(assets, &quot;index.html&quot;, &quot;window&quot;, client.WindowOptions{
        Size: client.Size{
            Width:  640,
            Height: 480,
        },
        Visible: true,
        URL:     &quot;http://localhost:8888/&quot;,
    })

    // we create a window with our options
    if _, err = bridge.Window.New(ctx, opts); err != nil {
        log.Fatal(err)
    }

    // meanwhile wait until hostbridge exits,
    // most likely from our main window being closed
    bridge.Wait()
}
</code></pre>
<p>Now we can put this file in a directory with an <code>index.html</code> (maybe from the <code>demo</code> dir again) and simply run <code>go build</code> to get a binary.</p>
<p>Since we&#39;re doing similar things as our builder does, we can reuse some of those utility functions. However, you could also make a program without them, and instead doing all hostbridge calls from Go, perhaps exposing them to JavaScript some other way or not at all.</p>
<p>For example, here is an even simpler Go program that doesn&#39;t even make a window (so it doesn&#39;t need to serve any files). It simply lets you pick some files using the native file picker dialog and then prints them out. </p>
<pre><code class="language-golang">package main

import (
    &quot;context&quot;
    &quot;fmt&quot;
    &quot;log&quot;

    &quot;tractor.dev/hostbridge/client&quot;
)

func main() {
    bridge, err := client.Spawn()
    if err != nil {
        log.Fatal(err)
    }
    defer bridge.Close()

    ctx := context.Background()
    files, err := bridge.Shell.ShowFilePicker(ctx, client.FileDialog{
        Mode: &quot;pickfiles&quot;,
    })
    if err != nil {
        log.Fatal(err)
    }

    for _, file := range files {
        fmt.Println(file)
    }

}
</code></pre>
<p>For something as simple as using this one native dialog, we don&#39;t have to invoke CGO and compile against tons of system headers. Hostbridge makes these APIs much more accessible for simple programs and scripts. </p>

<a href="#getting-help" id="getting-help" style="color: inherit; text-decoration: none;">
  <h2>Getting help</h2>
</a>
<p>There is a <code>#hostbridge</code> channel in the Progrium Discord. Feel free to ask for help or get involved in development there or file issues or PRs here.</p>

<a href="#license" id="license" style="color: inherit; text-decoration: none;">
  <h2>License</h2>
</a>
<p>TBD while sponsorware</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/Client.html" class="tsd-kind-icon">Client</a></li><li class="tsd-kind-class"><a href="classes/Menu.html" class="tsd-kind-icon">Menu</a></li><li class="tsd-kind-class"><a href="classes/Window.html" class="tsd-kind-icon">Window</a></li><li class="tsd-kind-interface"><a href="interfaces/Display.html" class="tsd-kind-icon">Display</a></li><li class="tsd-kind-interface"><a href="interfaces/Event.html" class="tsd-kind-icon">Event</a></li><li class="tsd-kind-interface"><a href="interfaces/FileDialog.html" class="tsd-kind-icon">File<wbr/>Dialog</a></li><li class="tsd-kind-interface"><a href="interfaces/MenuItem.html" class="tsd-kind-icon">Menu<wbr/>Item</a></li><li class="tsd-kind-interface"><a href="interfaces/MessageDialog.html" class="tsd-kind-icon">Message<wbr/>Dialog</a></li><li class="tsd-kind-interface"><a href="interfaces/Notification.html" class="tsd-kind-icon">Notification</a></li><li class="tsd-kind-interface"><a href="interfaces/Position.html" class="tsd-kind-icon">Position</a></li><li class="tsd-kind-interface"><a href="interfaces/Size.html" class="tsd-kind-icon">Size</a></li><li class="tsd-kind-interface"><a href="interfaces/WindowOptions.html" class="tsd-kind-icon">Window<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/app.html" class="tsd-kind-icon">app</a></li><li class="tsd-kind-interface"><a href="interfaces/menu.html" class="tsd-kind-icon">menu</a></li><li class="tsd-kind-interface"><a href="interfaces/screen.html" class="tsd-kind-icon">screen</a></li><li class="tsd-kind-interface"><a href="interfaces/shell.html" class="tsd-kind-icon">shell</a></li><li class="tsd-kind-interface"><a href="interfaces/window.html" class="tsd-kind-icon">window</a></li><li class="tsd-kind-function"><a href="modules.html#connect" class="tsd-kind-icon">connect</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>